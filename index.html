<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•´ì‹œíƒœê·¸ ì‰¼í‘œ ë³€í™˜ê¸°</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ê¸°ë³¸ ê¸€ê¼´ ì„¤ì • */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ (ì¢Œ: ë³€í™˜ê¸°, ìš°: ê¸°ë¡) -->
    <div class="flex flex-col lg:flex-row w-full max-w-5xl bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden">

        <!-- 1. ì¢Œì¸¡: í•´ì‹œíƒœê·¸ ë³€í™˜ê¸° UI -->
        <div class="lg:w-2/3 p-8 border-b lg:border-b-0 lg:border-r border-gray-100">
            <h1 class="text-3xl font-extrabold text-gray-800 mb-2 text-center lg:text-left">
                í•´ì‹œíƒœê·¸ ì‰¼í‘œ ë³€í™˜ê¸°
            </h1>
            <p class="text-sm text-gray-500 mb-8 text-center lg:text-left">
                ì¤„ ë°”ê¿ˆëœ í•´ì‹œíƒœê·¸ ëª©ë¡ì„ í•œ ì¤„ì˜ ì‰¼í‘œ(,) êµ¬ë¶„ ëª©ë¡ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
            </p>
    
            <!-- ì…ë ¥ ì˜ì—­ -->
            <div class="mb-6">
                <label for="inputArea" class="block text-sm font-medium text-gray-700 mb-2">
                    1. í•´ì‹œíƒœê·¸ ëª©ë¡ ë¶™ì—¬ë„£ê¸°
                </label>
                <textarea id="inputArea" rows="6" placeholder="ì—¬ê¸°ì— í•´ì‹œíƒœê·¸ ëª©ë¡ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. (ì¤„ ë°”ê¿ˆ í—ˆìš©)"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-gray-800 text-sm"></textarea>
            </div>
    
            <!-- ë²„íŠ¼ -->
            <button id="transformButton"
                    class="w-full flex items-center justify-center space-x-2 py-3 px-4 border border-transparent rounded-lg shadow-md text-lg font-bold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 transition duration-300 transform active:scale-98">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z" clip-rule="evenodd" />
                </svg>
                <span>2. ë³€í™˜ ë° ê²°ê³¼ ë³µì‚¬ ğŸ”„</span>
            </button>
    
            <!-- ê²°ê³¼ ì˜ì—­ -->
            <div class="mt-8">
                <label for="outputArea" class="block text-sm font-medium text-gray-700 mb-2">
                    3. ë³€í™˜ëœ ê²°ê³¼ (ìë™ìœ¼ë¡œ í´ë¦½ë³´ë“œì— ë³µì‚¬ë¨)
                </label>
                <textarea id="outputArea" rows="4" readonly placeholder="ë³€í™˜ëœ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."
                    class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 text-sm focus:outline-none cursor-text"></textarea>
                
                <!-- ë©”ì‹œì§€ ë°•ìŠ¤ -->
                <div id="messageBox" class="mt-4 hidden p-3 rounded-lg text-sm font-medium" role="alert"></div>
            </div>
        </div>

        <!-- 2. ìš°ì¸¡: ë³€í™˜ ê¸°ë¡ (History) -->
        <div class="lg:w-1/3 p-8">
            <h2 class="text-xl font-bold text-gray-700 mb-4">ìµœê·¼ ë³€í™˜ ê¸°ë¡ (History)</h2>
            <div id="historyList" class="space-y-3">
                <!-- History items will be inserted here -->
            </div>
            <p id="noHistory" class="text-sm text-gray-500 text-center mt-8 hidden">
                ë³€í™˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
            </p>
        </div>
        
    </div>

    <script>
        const inputArea = document.getElementById('inputArea');
        const outputArea = document.getElementById('outputArea');
        const transformButton = document.getElementById('transformButton');
        const messageBox = document.getElementById('messageBox');
        const historyList = document.getElementById('historyList');
        const noHistory = document.getElementById('noHistory');

        const MAX_HISTORY = 5;
        // conversionHistory ë°°ì—´ì— ë³€í™˜ëœ í…ìŠ¤íŠ¸ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
        let conversionHistory = [];

        /**
         * ì…ë ¥ëœ ë¬¸ìì—´ì„ í•´ì‹œíƒœê·¸ ì—†ëŠ” ì‰¼í‘œ(,) êµ¬ë¶„ ëª©ë¡ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
         * @param {string} input_text - ì›ë³¸ í…ìŠ¤íŠ¸
         * @returns {string} ë³€í™˜ëœ í…ìŠ¤íŠ¸
         */
        function transformText(input_text) {
            let result = input_text.trim();
            result = result.replace(/#/g, '');
            // ì¤„ ë°”ê¿ˆ ë¬¸ìë¥¼ ì‰¼í‘œë¡œ ëŒ€ì²´
            result = result.replace(/\n/g, ',');
            // ìµœì¢…ì ìœ¼ë¡œ ë‚¨ì•„ìˆëŠ” ì–‘ ë ê³µë°±, ì‰¼í‘œ ë° ì£¼ë³€ ê³µë°± ì œê±°
            result = result.trim().replace(/,\s*$/, '').trim();

            return result;
        }

        /**
         * ë©”ì‹œì§€ ë°•ìŠ¤ë¥¼ í‘œì‹œí•˜ê³  ì¼ì • ì‹œê°„ í›„ ìˆ¨ê¹ë‹ˆë‹¤.
         * @param {string} message - í‘œì‹œí•  ë©”ì‹œì§€
         * @param {string} type - 'success' ë˜ëŠ” 'error'
         */
        function showMessage(message, type) {
            messageBox.textContent = message;
            messageBox.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800');
            
            if (type === 'success') {
                messageBox.classList.add('bg-green-100', 'text-green-800');
            } else {
                messageBox.classList.add('bg-red-100', 'text-red-800');
            }

            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000);
        }

        /**
         * í…ìŠ¤íŠ¸ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤. (ìµœì‹  API ì‹¤íŒ¨ ì‹œ ë ˆê±°ì‹œ ëŒ€ì²´ ë°©ì‹ ì‚¬ìš©)
         * @param {string} text - ë³µì‚¬í•  í…ìŠ¤íŠ¸
         * @param {string} successMessage - ì„±ê³µ ì‹œ í‘œì‹œí•  ë©”ì‹œì§€
         */
        function copyToClipboard(text, successMessage) {
            // 1. ìµœì‹  navigator.clipboard.writeText() API ì‹œë„
            navigator.clipboard.writeText(text)
                .then(() => {
                    showMessage(successMessage, 'success');
                })
                .catch(err => {
                    // 2. ìµœì‹  API ì‹¤íŒ¨ ì‹œ (ë³´ì•ˆ ì •ì±… ë“±ìœ¼ë¡œ ì°¨ë‹¨ëœ ê²½ìš°) ë ˆê±°ì‹œ ëŒ€ì²´ ë°©ì‹ ì‚¬ìš©
                    console.error("í´ë¦½ë³´ë“œ API ì°¨ë‹¨ë¨, ë ˆê±°ì‹œ ëŒ€ì²´ ë³µì‚¬ ì‹œë„:", err);
                    
                    // ëŒ€ì²´ ë³µì‚¬: ì„ì‹œ textareaë¥¼ ìƒì„±í•˜ì—¬ ë³µì‚¬ ì‹œë„
                    const tempTextArea = document.createElement('textarea');
                    tempTextArea.value = text;
                    // í™”ë©´ ë°–ìœ¼ë¡œ ì´ë™í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ë³´ì´ì§€ ì•Šê²Œ ì²˜ë¦¬
                    tempTextArea.style.position = 'fixed';
                    tempTextArea.style.top = '0';
                    tempTextArea.style.left = '0';
                    tempTextArea.style.opacity = '0';
                    document.body.appendChild(tempTextArea);
                    
                    try {
                        tempTextArea.select();
                        tempTextArea.setSelectionRange(0, 99999);
                        document.execCommand('copy');
                        
                        showMessage(successMessage + " (ëŒ€ì²´ ë³µì‚¬ ë°©ì‹)", 'success');
                    } catch (execErr) {
                        console.error("ìµœì¢… ë³µì‚¬ ì‹¤íŒ¨", execErr);
                        showMessage(`í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ë³µì‚¬í•´ ì£¼ì„¸ìš”.`, 'error');
                    } finally {
                        document.body.removeChild(tempTextArea);
                    }
                });
        }

        /**
         * ë³€í™˜ëœ í…ìŠ¤íŠ¸ë¥¼ ê¸°ë¡ì— ì €ì¥í•˜ê³  ìµœëŒ€ ê°œìˆ˜ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
         * @param {string} text - ë³€í™˜ëœ í…ìŠ¤íŠ¸
         */
        function saveToHistory(text) {
            if (!text) return;

            // ìƒˆ í•­ëª©ì„ ë°°ì—´ ë§¨ ì•ì— ì¶”ê°€
            conversionHistory.unshift({ 
                text: text 
            });

            // ìµœëŒ€ ê°œìˆ˜ ìœ ì§€ (ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°)
            if (conversionHistory.length > MAX_HISTORY) {
                conversionHistory.pop();
            }
        }

        /**
         * ë³€í™˜ ê¸°ë¡ ë°°ì—´ì„ ê¸°ë°˜ìœ¼ë¡œ í™”ë©´ì— ëª©ë¡ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
         */
        function renderHistory() {
            historyList.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”
            
            if (conversionHistory.length === 0) {
                noHistory.classList.remove('hidden');
                return;
            }
            noHistory.classList.add('hidden');

            conversionHistory.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg shadow-sm hover:bg-gray-100 transition duration-150 border border-gray-200';
                
                // ìˆœì°¨ì  ë²ˆí˜¸ (ìµœê·¼ í•­ëª©ì´ 1ë²ˆ)
                const itemNumber = index + 1; 

                // í…ìŠ¤íŠ¸ í‘œì‹œ (ê¸¸ì´ê°€ ê¸¸ë©´ ì¤„ì„í‘œ ì²˜ë¦¬)
                const displayText = item.text.length > 50 
                                    ? item.text.substring(0, 50) + '...' 
                                    : item.text;

                historyItem.innerHTML = `
                    <div class="flex-1 min-w-0 pr-2">
                        <span class="text-xs font-semibold text-gray-500 mr-2">${itemNumber}.</span>
                        <p class="text-sm text-gray-700 truncate" title="${item.text}">
                            ${displayText}
                        </p>
                    </div>
                    <button data-text="${item.text}" class="copy-history-btn flex-shrink-0 ml-2 py-1 px-3 text-xs font-medium text-blue-700 bg-blue-100 rounded-lg hover:bg-blue-200 transition duration-150">
                        ë³µì‚¬í•˜ê¸°
                    </button>
                `;

                historyList.appendChild(historyItem);
            });

            // ë™ì ìœ¼ë¡œ ìƒì„±ëœ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('.copy-history-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    // data-text ì†ì„±ì—ì„œ ì‹¤ì œ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜´
                    const textToCopy = e.currentTarget.getAttribute('data-text');
                    copyToClipboard(textToCopy, 'ë³€í™˜ ê¸°ë¡ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                });
            });
        }


        // ë©”ì¸ ë³€í™˜ ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
        transformButton.addEventListener('click', () => {
            const originalText = inputArea.value;

            if (!originalText.trim()) {
                showMessage("ë³€í™˜í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ì…ë ¥ ì˜ì—­ì— í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”.", 'error');
                outputArea.value = "";
                return;
            }

            try {
                // 1. ë‚´ìš© ë³€í™˜
                const transformedText = transformText(originalText);
                
                // 2. ë³€í™˜ëœ ê²°ê³¼ë¥¼ GUI í…ìŠ¤íŠ¸ ë°•ìŠ¤ì— í‘œì‹œ
                outputArea.value = transformedText;
                
                // 3. ê¸°ë¡ì— ì €ì¥ ë° ë Œë”ë§
                saveToHistory(transformedText);
                renderHistory();

                // 4. ë³€í™˜ëœ ê²°ê³¼ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬ (ë©”ì¸ ì¶œë ¥)
                copyToClipboard(transformedText, "ë³€í™˜ ì„±ê³µ! ê²°ê³¼ê°€ í™”ë©´ì— í‘œì‹œë˜ì—ˆìœ¼ë©°, í´ë¦½ë³´ë“œì— ìë™ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");

            } catch (e) {
                showMessage(`ì‘ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${e.message}`, 'error');
            }
        });

        // ì´ˆê¸° ë Œë”ë§ (ë³€í™˜ ê¸°ë¡ì´ ì—†ì„ ë•Œ 'ë³€í™˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤' ë©”ì‹œì§€ í‘œì‹œ)
        renderHistory();
    </script>
</body>
</html>
